# Roles & Permissions

TIP-20 tokens use a role-based access control system that allows you to delegate different administrative functions to different addresses. This is essential for security and operational flexibility.

## Available Roles

| Role | Purpose | Key Functions |
|------|---------|---------------|
| `defaultAdmin` | Full control | Grant/revoke all roles, set supply caps, change policies |
| `issuer` | Token supply | Mint and burn tokens |
| `pause` | Emergency control | Pause token transfers |
| `unpause` | Emergency control | Unpause token transfers |
| `burnBlocked` | Compliance | Burn tokens from blocked addresses |

## Granting Roles

### Grant Issuer Role

:::code-group
```ts [issuer.ts]
const treasuryAddress = '0xdeadbeefcafebabedeadbeefcafebabedeadbeef' // [!code focus]

const hash = await client.token.grantRoles({ // [!code focus]
  roles: ['issuer'], // [!code focus]
  to: treasuryAddress, // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

### Grant Pause Role

:::code-group
```ts [pause.ts]
const securityTeamAddress = '0xdeadbeefcafebabedeadbeefcafebabedeadbeef' // [!code focus]

const hash = await client.token.grantRoles({ // [!code focus]
  roles: ['pause'], // [!code focus]
  to: securityTeamAddress, // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

### Grant Multiple Roles

:::code-group
```ts [multipleRoles.ts]
const securityTeamAddress = '0xdeadbeefcafebabedeadbeefcafebabedeadbeef' // [!code focus]

const hash = await client.token.grantRoles({ // [!code focus]
  roles: ['issuer', 'pause', 'unpause'], // [!code focus]
  to: securityTeamAddress, // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

## Revoking Roles

:::code-group
```ts [revoke.ts]
const treasuryAddress = '0xdeadbeefcafebabedeadbeefcafebabedeadbeef' // [!code focus]

// Remove minting rights from old treasury // [!code focus]
const hash = await client.token.revokeRoles({ // [!code focus]
  from: treasuryAddress, // [!code focus]
  roles: ['issuer'], // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

### Separate Concerns

Don't give all roles to one address:

- **Treasury team**: `issuer` only
- **Security team**: `pause` and `unpause`
- **Compliance team**: `burnBlocked`
- **Governance**: `defaultAdmin`

{/* ### Regular Audits

Periodically review who has what roles:

:::code-group
```ts [getRoles.ts]
// Check all roles for an address
const roles = [
  'DEFAULT_ADMIN_ROLE',
  'ISSUER_ROLE', 
  'PAUSE_ROLE',
  'UNPAUSE_ROLE',
  'BURN_BLOCKED_ROLE'
]

for (const roleName of roles) {
  const role = '0x' + keccak256(roleName).slice(2)
  const hasRole = await token.read.hasRole([role, addressToCheck])
  console.log(`${roleName}: ${hasRole}`)
}
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::
 */}

## Role Events

The token emits events when roles are granted or revoked:

:::code-group
```ts [monitorRoles.ts]
await client.token.watchRole({ // [!code focus]
  onRoleUpdated: (args) => { // [!code focus]
    console.log(`Role ${args.role} ${args.type === 'granted' ? 'granted to' : 'revoked from'} ${args.account}`) // [!code focus]
  }, // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

## Emergency Procedures

### Immediate Pause

If you have `pause`, you can immediately stop all transfers:

:::code-group
```ts [pause.ts]
const hash = await client.token.pause({ // [!code focus]
  token: '0x20c0000000000000000000000000000000000004', // [!code focus]
}) // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::


### Remove Compromised Roles

If an address is compromised, immediately revoke all roles:

:::code-group
```ts [removeRoles.ts]
const compromisedAddress = '0xdeadbeefcafebabedeadbeefcafebabedeadbeef' // [!code focus]

const roles = [
  'DEFAULT_ADMIN_ROLE',
  'ISSUER_ROLE', 
  'PAUSE_ROLE',
  'UNPAUSE_ROLE',
  'BURN_BLOCKED_ROLE'
]

for (const roleName of roles) { // [!code focus]
  const role = '0x' + keccak256(roleName).slice(2) // [!code focus]
  const hash = await client.token.revokeRoles({ // [!code focus]
    role: role, // [!code focus]
    account: compromisedAddress, // [!code focus]
  }) // [!code focus]
  console.log(`${roleName} revoke hash: ${hash}`) // [!code focus]

  const hasRole = await token.read.hasRole([role, addressToCheck]) // [!code focus]

  console.log(`${roleName}: ${hasRole}`) // [!code focus]
} // [!code focus]
```

```ts [viem.config.ts]
// [!include ~/snippets/setup.ts:setup] 
```
:::

For detailed technical specifications, see the [TIP-20 Protocol Reference](/protocol/tokens/tip-20).
